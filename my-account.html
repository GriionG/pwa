<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>GoalGear</title>
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta content="eCommerce HTML Template Free Download" name="keywords">
        <meta content="eCommerce HTML Template Free Download" name="description">

        <!-- Favicon -->
        <link href="img/icono.png" rel="icon">

        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400|Source+Code+Pro:700,900&display=swap" rel="stylesheet">

        <!-- CSS Libraries -->
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
        <link rel="stylesheet" href="css/style1.css">

        <script>
        // Simulación de usuarios registrados
        const usuarios = [
            {
                id_usuario: 1,
                email: "user1@example.com",
                password: "1234",
                nombre: "Juan",
                apellidos: "Pérez",
                direccion: "Calle Falsa 123",
                telefono: "5551234567",
                descripcion: "Usuario regular",
                privilegio: "Usuario",
                discapacidad: "Daltonico",
                pregunta: "¿Color favorito?",
                respuesta: "Azul"
            },
            {
                id_usuario: 2,
                email: "admin@example.com",
                password: "admin123",
                nombre: "Ana",
                apellidos: "López",
                direccion: "Avenida Siempre Viva 742",
                telefono: "5559876543",
                descripcion: "Administrador del sistema",
                privilegio: "Admin",
                discapacidad: "Ninguna",
                pregunta: "¿Ciudad natal?",
                respuesta: "México"
            }
        ];

        // Función para iniciar sesión
        function iniciarSesion(email, password) {
            const usuario = usuarios.find(user => user.email === email && user.password === password);
            if (usuario) {
                localStorage.setItem("usuario", JSON.stringify(usuario));
                alert(`Bienvenido, ${usuario.nombre}`);
                location.href = "index.html"; 
            } else {
                alert("Correo o contraseña incorrectos.");
            }
        }

        // Obtener datos del usuario logueado
        function obtenerUsuarioLogueado() {
            return JSON.parse(localStorage.getItem("usuario"));
        }

        // Cerrar sesión
        function cerrarSesion() {
            localStorage.removeItem("usuario");
            alert("Sesión cerrada.");
            location.href = "login.html";
        }

        // Configurar la barra de navegación y mostrar contenido según el usuario logueado
        function configurarNavBar() {
            const usuario = obtenerUsuarioLogueado();
            const navLinks = document.getElementById("nav-links");
            const userSection = document.getElementById("user-section");

            if (!navLinks || !userSection) {
                console.error("No se encontraron los elementos 'nav-links' o 'user-section'.");
                return;
            }

            navLinks.innerHTML = `
                <a href="index.html" class="nav-item nav-link active">Inicio</a>
                <a href="my-account.html" class="nav-item nav-link">Conócenos</a>
            `;

            if (usuario) {
                if (usuario.privilegio === "Usuario" || usuario.privilegio === "Admin") {
                    navLinks.innerHTML += `<a href="contact.php" class="nav-item nav-link">Contáctanos</a>`;
                }

                userSection.innerHTML = `
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">${usuario.nombre}</a>
                        <div class="dropdown-menu">
                            <a href="profile.php" class="dropdown-item">Perfil</a>
                            ${usuario.privilegio === "Admin" ? '<a href="brands.php" class="dropdown-item">Admin</a>' : ""}
                            <a href="#" class="dropdown-item" onclick="cerrarSesion()">Cerrar sesión</a>
                        </div>
                    </div>
                `;
            } else {
                userSection.innerHTML = `<a href="login.html" class="nav-item nav-link">Iniciar sesión</a>`;
            }
        }

        // Mostrar contenido dinámico basado en el usuario
        function mostrarContenido() {
            const usuario = obtenerUsuarioLogueado();
            if (!usuario) {
                alert("Debes iniciar sesión.");
                location.href = "login.html";
                return;
            }

            document.getElementById("user-name").textContent = `Bienvenido, ${usuario.nombre}`;
            document.getElementById("bienvenida").textContent = `Hola ${usuario.nombre} ${usuario.apellidos}, tienes privilegio de ${usuario.privilegio}.`;
            document.getElementById("discapacidad").textContent = `Discapacidad registrada: ${usuario.discapacidad}.`;

            // Cambiar archivo CSS según discapacidad
            let cssLink = document.createElement("link");
            cssLink.rel = "stylesheet";
            if (usuario.discapacidad === "Daltonico") {
                cssLink.href = "css/style-daltonico.css";
            } else if (usuario.discapacidad === "Miope") {
                cssLink.href = "css/style-miope.css";
            } else if (usuario.discapacidad === "Ciego" || usuario.discapacidad === "Ninguna") {
                cssLink.href = "css/style1.css";
            }
            document.head.appendChild(cssLink);
        }

        document.addEventListener("DOMContentLoaded", configurarNavBar);
        </script>
    </head>
    <body>
        <!-- Barra superior -->
        <div class="top-bar">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-6">
                        <i class="fa fa-envelope"></i>
                        Goalgear@gmail.com
                    </div>
                    <div class="col-sm-6">
                        <i class="fa fa-phone-alt"></i>
                        +52-878-137-0387
                    </div>
                </div>
            </div>
        </div>
        <!-- Barra inferior -->
        <div class="bottom-bar">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-md-3">
                        <div class="logo">
                            <a href="index.html">
                                <img style="max-width: 60%; height: 100px;" src="img/Logo-goal.png" alt="Logo">
                            </a>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="search">
                            <form action="product-list.php" method="post">
                                <input type="text" class="form-control" name="txtbuscar" id="txtbuscar" placeholder="Buscar">
                                <button type="submit" name="btnbuscar" id="btnbuscar" class="btn"><i class="fa fa-search"></i></button>
                            </form>
                        </div>
                    </div>
                    <div class="col-md-3" id="user-section"></div>
                </div>
            </div>
        </div>

        <!-- Barra de navegación dinámica -->
        <div id="nav-links"></div>

        <script>
        document.addEventListener("DOMContentLoaded", mostrarContenido);
        </script>
    </body>
</html>
