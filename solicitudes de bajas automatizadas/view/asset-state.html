<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Estado de solicitudes</title>
    <!-- Favicon en formato PNG -->
    <link rel="icon" href="../img/CBI_Logo-removebg-preview.png" type="image/png">
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
     <!-- Agregar Google Fonts (Ejemplo con "Roboto" y "Poppins") -->
     <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <!-- Style CSS -->
    <link rel='stylesheet' type='text/css' media='screen' href='../css/style.css'>
    <!-- Incluye Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- Incluye Bootstrap 5 (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Incluye fontawesome -->
    <script src="https://kit.fontawesome.com/f7f523ca7f.js" crossorigin="anonymous"></script>
    <script src='main.js'></script>
    </head>
    <body>
        <header class="header d-flex justify-content-between align-items-center">
            <div class="logo-container">
                <a href="home.html">
                    <img src="../img/CBI_Logo-removebg-preview.png" alt="Logo de la empresa" class="logo">
                </a>
            </div>
            <div class="icon-container d-flex">
                <a href="#" class="icon-header icon-bars" id="menu-toggle">
                    <i class="fa-solid fa-bars"></i>
                    <span class="icon-text">Menú</span>
                </a>
                <a href="#" class="icon-header" id="adminLink">
                    <i class="fa-solid fa-gear"></i>
                    <span class="icon-text" id="adminText">Admin</span>
                </a>
            </div>
            <div class="icon-container-right d-flex">
                <a href="#" class="icon-header" onclick="logout()">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    <span class="icon-text">Cerrar sesion</span>
                </a>
                <a href="user-profile.html" class="icon-header">
                    <i class="fa-solid fa-circle-user"></i>
                    <span class="icon-text" id="roleText">Perfil</span>
                </a>
            </div>
        </header>
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <a href="#" class="sidebar-item" onclick="closeSidebar()">Inicio</a> 
                <a href="login.html" class="sidebar-item" onclick="closeSidebar()">Inicio de Sesión</a>
                <a href="user-register.html" class="sidebar-item" onclick="closeSidebar()">Registro de Usuario</a>
                <a href="asset-state.html" class="sidebar-item active" onclick="closeSidebar()">Estado de Solicitudes</a>
                <a href="#" class="sidebar-item" onclick="logout()">Cerrar Sesión</a>
            </div>
            <!-- Overlay -->
            <div class="overlay" id="overlay"></div>
            <div class="container mt-4">
                <h2 class="text-center">Estados de Solicitudes</h2>
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead class="table-primary">
                            <tr>
                                <th hidden>ID Solicitud</th>
                                <th>Usuario</th>
                                <th>Area</th>
                                <th>Puesto</th>
                                <th>Fecha</th>
                                <th>Hora</th>
                                <th>Nombre Activo</th>
                                <th>N. serie</th>
                                <th>N. Tal</th>
                                <th>Marca</th>
                                <th>Descripcion</th>
                                <th>Defecto</th>
                                <th>Localizacion</th>
                                <th>Responsable</th>
                                <th>Fecha de caducidad</th>
                                <th>Proceso</th>
                                <th>Estatus</th>
                                <th>Respuesta</th>
                                <th>Documento</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td hidden>001</td>
                                <td id="name"></td>
                                <td id="area"></td>
                                <td id="puesto"></td>
                                <td>2025-01-29</td>
                                <td>10:30 AM</td>
                                <td>Pantalla plasma LG</td>
                                <td>123456789</td>
                                <td>987654321</td>
                                <td>LG</td>
                                <td>Pantalla plasma para conferencias</td>
                                <td>Está estrellada la pantalla y se escurre tinta</td>
                                <td>Área de Gente y Cultura</td>
                                <td>Juan Perez</td>
                                <td>2027-01-29</td>
                                <td>Reparación</td>
                                <td>En revisión</td>
                                <td>Pendiente...</td>
                                <td><button hidden class="btn btn-primary btn-sm me-2" onclick="confirmAsset()">
                                    <i class="fa-solid fa-pen"></i> <!-- Icono de palomita -->
                                </button>
                                </td>
                            </tr>
                            <tr>
                                <td hidden>002</td>
                                <td id="name"></td>
                                <td id="area"></td>
                                <td id="puesto"></td>
                                <td>2025-01-28</td>
                                <td>3:45 PM</td>
                                <td>Impresora Epson</td>
                                <td>654321987</td>
                                <td>321987654</td>
                                <td>Epson</td>
                                <td>Impresora láser a color</td>
                                <td>Baja calidad de impresión</td>
                                <td>Área de Administración</td>
                                <td>Marìa Sanchez</td>
                                <td>2029-02-15</td>
                                <td>Mantenimiento</td>
                                <td>Finalizado</td>
                                <td>Traslada el activo a esta área.</td>
                                <td><button class="btn btn-primary btn-sm me-2" onclick="confirmAsset()">
                                    <i class="fa-solid fa-pen"></i> <!-- Icono de palomita -->
                                </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- Footer -->
    <footer class="footer" style=" position: absolute;">
        <div class="container text-center">
            <p class="m-0 text-white">&copy; 2025. Todos los derechos reservados.</p>
        </div>
    </footer>
    </body>
    <script>
        //barra lateral de opciones 
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("overlay");
        const menuToggle = document.getElementById("menu-toggle");

        menuToggle.addEventListener("click", function () {
            sidebar.style.left = "0px"; 
            overlay.style.display = "block"; 
        });

        function closeSidebar() {
            sidebar.style.left = "-250px"; 
            overlay.style.display = "none"; 
        }

        // opcion de guia 
        overlay.addEventListener("click", closeSidebar);

        
        document.addEventListener("DOMContentLoaded", function() {
    const userData = JSON.parse(localStorage.getItem("userData"));
    if (userData) {
        const userName = userData.name || "";
        const userArea = userData.area || "";
        const userPuesto = userData.position || "";

        // Asignar el nombre del usuario a todas las celdas con id "name"
        document.querySelectorAll("td[id='name']").forEach(cell => {
            cell.textContent = userName;
        });

        // Asignar el área del usuario a todas las celdas con id "area"
        document.querySelectorAll("td[id='area']").forEach(cell => {
            cell.textContent = userArea;
        });

        // Asignar el puesto del usuario a todas las celdas con id "puesto"
        document.querySelectorAll("td[id='puesto']").forEach(cell => {
            cell.textContent = userPuesto;
        });
    }
});
    
// Función para cargar el rol del usuario desde localStorage
function loadUserRole() {
        const userData = JSON.parse(localStorage.getItem('userData'));
        if (userData) {
            const role = userData.role;  // Obtener el rol del usuario
            const adminText = document.getElementById('adminText');
            const roleText = document.getElementById('roleText');
            
            // Cambiar el texto y los íconos según el rol
            if (role === 'admin') {
                adminText.textContent = 'Administrar';
                roleText.textContent = 'Perfil';
            } else if (role === 'moderador') {
                adminText.textContent = 'Moderación';
                roleText.textContent = 'Perfil';
            } else if (role === 'usuario') {
                adminText.textContent = 'Acciones';
                roleText.textContent = 'Perfil';
            }
        }
    }

    // Llamar a la función para cargar el rol cuando la página cargue
    window.onload = loadUserRole;

    // Función de logout
    function logout() {
        localStorage.removeItem('isAuthenticated');
        localStorage.removeItem('userData');
        window.location.href = 'login.html';  // Redirigir al login después del logout
    }

    // Función para cargar el rol del usuario desde localStorage
    function loadUserRole() {
        const userData = JSON.parse(localStorage.getItem('userData'));
        if (userData) {
            const role = userData.role;  // Obtener el rol del usuario
            const adminText = document.getElementById('adminText');
            const roleText = document.getElementById('roleText');
            const adminLink = document.getElementById('adminLink');

            // Cambiar el texto y los íconos según el rol
            if (role === 'admin') {
                adminText.textContent = 'Administrar';
                roleText.textContent = 'Perfil';
            } else if (role === 'moderador') {
                adminText.textContent = 'Moderación';
                roleText.textContent = 'Perfil';
            } else if (role === 'usuario') {
                adminText.textContent = 'Acciones';
                roleText.textContent = 'Perfil';

                // Ocultar el link de administración si es usuario
                adminLink.style.display = 'none';
            }
        }
    }

    // Llamar a la función para cargar el rol cuando la página cargue
    window.onload = loadUserRole;

    // Función de logout con confirm
    function logout() {
        const confirmLogout = confirm("¿Estás seguro que deseas cerrar sesión?");
        if (confirmLogout) {
            // Reiniciar el estado de autenticación
            localStorage.setItem("isAuthenticated", "false");
            localStorage.removeItem('userData');
            
            // Mensaje de despedida
            alert("Hasta la próxima. Has cerrado sesión.");
            
            // Redirigir a la página de inicio de sesión
            window.location.href = "login.html";
        }
    }
    

</script>
</html>